<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kalkulator Status Gizi Anak</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #fff8f0;
      color: #333;
    }
    h1 {
      color: orange;
    }
    .gender-option {
      display: inline-block;
      text-align: center;
      margin-right: 20px;
    }
    .gender-option input {
      display: none;
    }
    .gender-option label {
      display: block;
      cursor: pointer;
    }
    .gender-option img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid transparent;
    }
    .gender-option input:checked + label img {
      border-color: orange;
    }
    form label {
      display: block;
      margin: 10px 0 5px;
    }
    input {
      width: 100%;
      padding: 5px;
      font-size: 16px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: orange;
      color: white;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }
    .hasil, .saran {
      margin-top: 20px;
      background-color: #fff3e0;
      padding: 15px;
      border-radius: 10px;
    }
    canvas {
      margin-top: 30px;
      max-width: 100%;
    }
    @media (max-width: 600px) {
      .gender-option {
        margin-bottom: 10px;
        display: block;
      }
    }
  </style>
</head>

<body>
  <h1>Kalkulator Status Gizi Anak</h1>
  <form id="formGizi">
    <label>Nama Anak
      <input type="text" id="nama">
    </label>
    <label>Usia (bulan)
      <input type="number" id="usia">
    </label>
    <label>Berat Badan (kg)
      <input type="number" id="bb">
    </label>
    <label>Tinggi Badan (cm)
      <input type="number" id="tb">
    </label>
    <div>
      <label>Jenis Kelamin</label><br>
      <div class="gender-option">
        <input type="radio" id="laki" name="jk" value="L" checked>
        <label for="laki"><img src="https://img.icons8.com/color/96/boy.png" alt="Laki-laki"><br>Laki-laki</label>
      </div>
      <div class="gender-option">
        <input type="radio" id="perempuan" name="jk" value="P">
        <label for="perempuan"><img src="https://img.icons8.com/color/96/girl.png" alt="Perempuan"><br>Perempuan</label>
      </div>
    </div>
    <button type="button" onclick="hitungGizi()">Hitung Status Gizi</button>
  </form>

// script.js
const hasilDiv = document.getElementById('hasil');
const saranDiv = document.getElementById('saran');

function hitungZScore(nilai, median, sd) {
  return (nilai - median) / sd;
}

function interpretasiBBU(z) {
  if (z < -3) return "Gizi Buruk";
  if (z < -2) return "Gizi Kurang";
  if (z <= 2) return "Gizi Baik";
  return "Gizi Lebih";
}

function interpretasiTBU(z) {
  if (z < -3) return "Sangat Pendek";
  if (z < -2) return "Pendek";
  if (z <= 2) return "Normal";
  return "Tinggi";
}

function interpretasiBBTB(z) {
  if (z < -3) return "Sangat Kurus";
  if (z < -2) return "Kurus";
  if (z <= 2) return "Normal";
  return "Gemuk";
}

function hitungGizi() {
  const nama = document.getElementById('nama').value;
  const usia = parseInt(document.getElementById('usia').value);
  const bb = parseFloat(document.getElementById('bb').value);
  const tb = parseFloat(document.getElementById('tb').value);
  const jk = document.querySelector('input[name="jk"]:checked').value;

  // Simulasi nilai median dan SD â€” diupdate dengan data riil Permenkes No. 2 Tahun 2020
  const medianBBU = jk === "L" ? 10 : 9.5;
  const sdBBU = 1.2;

  const medianTBU = jk === "L" ? 80 : 78;
  const sdTBU = 3.5;

  const medianBBTB = jk === "L" ? 12 : 11.5;
  const sdBBTB = 1.5;

  const zBBU = hitungZScore(bb, medianBBU, sdBBU);
  const zTBU = hitungZScore(tb, medianTBU, sdTBU);
  const zBBTB = hitungZScore(bb / (tb / 100), medianBBTB, sdBBTB);

  const statusBBU = interpretasiBBU(zBBU);
  const statusTBU = interpretasiTBU(zTBU);
  const statusBBTB = interpretasiBBTB(zBBTB);

  hasilDiv.innerHTML = `
    <h3>Hasil Status Gizi untuk ${nama}</h3>
    <ul>
      <li><b>BB/U:</b> ${statusBBU}</li>
      <li><b>TB/U:</b> ${statusTBU}</li>
      <li><b>BB/TB:</b> ${statusBBTB}</li>
    </ul>
  `;

  saranDiv.innerHTML = `
    <h3>Saran</h3>
    <ul>
      <li><b>BB/U:</b> ${statusBBU === "Gizi Baik" ? "Pertahankan pola makan anak." : "Perhatikan asupan kalori dan frekuensi makan anak."}</li>
      <li><b>TB/U:</b> ${statusTBU === "Normal" ? "Pertahankan gizi dan stimulasi tumbuh kembang." : "Konsultasikan dengan tenaga kesehatan terkait pertumbuhan anak."}</li>
      <li><b>BB/TB:</b> ${statusBBTB === "Normal" ? "Pertahankan berat badan ideal anak." : "Perbaiki gizi seimbang dan pemantauan berat badan secara berkala."}</li>
    </ul>
  `;

  tampilkanGrafik(usia, bb, tb, jk);
}

function tampilkanGrafik(usia, bb, tb, jk) {
  const warna = jk === "L" ? 'blue' : 'pink';

  new Chart(document.getElementById('chartBBU'), {
    type: 'line',
    data: {
      labels: [usia],
      datasets: [{
        label: 'BB/U',
        data: [bb],
        borderColor: warna,
        backgroundColor: warna,
        fill: false
      }]
    }
  });

  new Chart(document.getElementById('chartTBU'), {
    type: 'line',
    data: {
      labels: [usia],
      datasets: [{
        label: 'TB/U',
        data: [tb],
        borderColor: warna,
        backgroundColor: warna,
        fill: false
      }]
    }
  });

  new Chart(document.getElementById('chartBBTB'), {
    type: 'line',
    data: {
      labels: [tb],
      datasets: [{
        label: 'BB/TB',
        data: [bb],
        borderColor: warna,
        backgroundColor: warna,
        fill: false
      }]
    }
  });
}

async function unduhPDF() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();

  await html2canvas(document.body).then((canvas) => {
    const imgData = canvas.toDataURL("image/png");
    pdf.addImage(imgData, "PNG", 0, 0, 210, 297);
    pdf.save("status_gizi_anak.pdf");
  });
}

  
  <div class="hasil" id="hasil"></div>
  <div class="saran" id="saran"></div>

  <canvas id="chartBBU"></canvas>
  <canvas id="chartTBU"></canvas>
  <canvas id="chartBBTB"></canvas>

  <button onclick="unduhPDF()">Unduh PDF</button>

  <script src="script.js"></script>
</body>

</html>
